<div class="todo-container">
  <!-- Header with Logout -->
  <div class="todo-header">
    <h1>My Tasks</h1>
    <button (click)="logout()" class="btn-logout">Logout</button>
  </div>

  <!-- Stats -->
<div class="todo-stats">
  <div class="stat-item">
    <span class="stat-label">Active Tasks</span>
    <span class="stat-value">
      {{ statsLoading ? '...' : (taskStats?.active || activeCount) }}
    </span>
  </div>
  <div class="stat-item">
    <span class="stat-label">Completed</span>
    <span class="stat-value">
      {{ statsLoading ? '...' : (taskStats?.completed || completedCount) }}
    </span>
  </div>
  <div class="stat-item">
    <span class="stat-label">Total Tasks</span>
    <span class="stat-value">
      {{ statsLoading ? '...' : (taskStats?.total || todos.length) }}
    </span>
  </div>
  <div class="stat-badge" *ngIf="taskStats">
    <span title="Powered by Cloud Functions">Live Stats</span>
  </div>
</div>

  <!-- Add New Todo Form -->
  <div class="add-todo-form">
    <input
      type="text"
      [(ngModel)]="newTodoTitle"
      placeholder="What needs to be done?"
      (keyup.enter)="addTodo()"
      [disabled]="loading"
      class="input-title"
    />
    <input
      type="text"
      [(ngModel)]="newTodoDescription"
      placeholder="Description (optional)"
      (keyup.enter)="addTodo()"
      [disabled]="loading"
      class="input-description"
    />
    <button 
      (click)="addTodo()" 
      [disabled]="loading || !newTodoTitle.trim()"
      class="btn-add"
    >
      <span *ngIf="!loading">Add Task</span>
      <span *ngIf="loading">Adding...</span>
    </button>
  </div>

  <!-- Filter Buttons -->
  <div class="filter-buttons">
    <button 
      (click)="setFilter('all')" 
      [class.active]="filter === 'all'"
      class="btn-filter"
    >
      All
    </button>
    <button 
      (click)="setFilter('active')" 
      [class.active]="filter === 'active'"
      class="btn-filter"
    >
      Active
    </button>
    <button 
      (click)="setFilter('completed')" 
      [class.active]="filter === 'completed'"
      class="btn-filter"
    >
      Completed
    </button>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading && todos.length === 0" class="loading">
    Loading tasks...
  </div>

  <!-- Empty State -->
  <div *ngIf="!loading && filteredTodos.length === 0" class="empty-state">
    <p *ngIf="filter === 'all'">No tasks yet. Add one above!</p>
    <p *ngIf="filter === 'active'">No active tasks.</p>
    <p *ngIf="filter === 'completed'">No completed tasks.</p>
  </div>

  <!-- Todo List -->
  <div class="todo-list">
    <div 
      *ngFor="let todo of filteredTodos" 
      class="todo-item"
      [class.completed]="todo.completed"
    >
      <div class="todo-checkbox">
        <input
          type="checkbox"
          [checked]="todo.completed"
          (change)="toggleComplete(todo)"
          [id]="'todo-' + todo.id"
        />
        <label [for]="'todo-' + todo.id"></label>
      </div>
      
      <div class="todo-content">
        <h3>{{ todo.title }}</h3>
        <p *ngIf="todo.description">{{ todo.description }}</p>
        <small>{{ getDate(todo.createdAt) | date:'short' }}</small>
      </div>
      
      <button 
        (click)="deleteTodo(todo)" 
        class="btn-delete"
        title="Delete task"
      >
        Ã—
      </button>
    </div>
  </div>
</div>